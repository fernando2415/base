base de datos
====

USE VENTASCIB

SELECT V.NOM_VEN,V.APE_VEN,D.NOM_DIS
FROM TB_VENDEDOR V INNER JOIN TB_DISTRITO D 
ON V.COD_DIS=D.COD_DIS

CREATE PROCEDURE SP_VENDEDOR_DISTRITO
AS
BEGIN
     SELECT V.NOM_VEN, V.APE_VEN, D.NOM_DIS
	 FROM TB_VENDEDOR V INNER JOIN TB_DISTRITO
	 ON V.COD_DIS=D.COD_DIS
END
EXEC SP_VENDEDOR_DISTRITO

/* CONSULTA Q MUESTRE NOM PRO PREC PRO LOS PRODUCTOS  CUYA MEDIDA SEA MLL 
*/

SELECT P.DES_PRO, P.PRE_PRO, PR.RAZ_SOC_PRV
FROM TB_PRODUCTO P INNER JOIN TB_ABASTECIMIENTO A
ON P.COD_PRO=A.COD_PRO
               INNER JOIN TB_PROVEEDOR PR
ON A.COD_PRV=PR.COD_PRV
WHERE P.UNI_MED='MLL'

/*ELABORE UNA CONSULTA Q MUESTRE RAZON SOCIAL DE CLIENTES , NOM DISTRITO AL CUAL PERTENEC , NUM FACTURA, DE TODOS LOS CLIENTES(TENGAN O NO FACTURA SIN USAR WHERE)*/

 
 SELECT C.RAZ_SOC_CLI,D.NOM_DIS,F.NUM_FAC
 FROM TB_CLIENTE C LEFT JOIN TB_DISTRITO D
 ON C.COD_DIS=D.COD_DIS
                      LEFT JOIN TB_FACTURA F
ON C.COD_CLI=F.COD_CLI
ORDER BY F.NUM_FAC, C.RAZ_SOC_CLI


SELECT * FROM TB_PRODUCTO

----SUBCONSULTAS
/* ELABORAR UNA CONSULTA QUE MUESTRE TODOS LOS ENDEDORES CUYO NOMBRE DE DISTRITO EMPIECEN CON LA LETRA S*/


SELECT * 
  FROM TB_VENDEDOR
WHERE COD_DIS  IN
 (SELECT COD_DIS FROM TB_DISTRITO WHERE NOM_DIS LIKE 'S%') 


 ---- ejemplo de poblar una tabla con una sub consulta

     CREATE TABLE TB_DISTRITO_BCK(
	    [COD_DIS] [CHAR](5) NOT NULL,
		[NOM_DIS] [VARCHAR] (50) NULL,
		)

	INSERT INTO TB_DISTRITO_BCK(COD_DIS,NOM_DIS)
		   SELECT COD_DIS,NOM_DIS FROM TB_DISTRITO

		   SELECT * FROM TB_DISTRITO_BCK
             
  [COD_DIS] [CHAR](5) NOT NULL,
		[NOM_DIS] [VARCHAR] (50) NULL,
		)

	INSERT INTO TB_DISTRITO_BCK(COD_DIS,NOM_DIS)
		   SELECT COD_DIS,NOM_DIS FROM TB_DISTRITO

		   SELECT * FROM TB_DISTRITO_BCK
        
    SELECT * FROM TB_PRODUCTO
	WHERE PRE_PRO > ANY (SELECT PRE_VEN FROM TB_DETALLE_FACTURA WHERE CAN_VEN>10)


